# STL10 VGG16 Inference UI

GUI-приложение для демонстрации классификации STL-10 на VGG16 и генерации адверсариальных примеров для одного выбранного изображения. Приложение работает с локальными файлами и не сохраняет результаты на диск.

## Что делает приложение

- Загружает STL-10 train из бинарников.
- Показывает список индексов изображений (train).
- Показывает превью выбранного изображения (96×96).
- Запускает инференс для выбранных индексов.
- Открывает окно атак и генерирует адверсариальные примеры (FGSM, BIM, PGD, DeepFool, C&W, AutoAttack).
- Показывает, как меняется предсказание после каждой атаки, нормы L∞/L2 и время.

## Структура проекта

- `main.py` — точка входа web-приложения.
- `web_app.py` — Flask-приложение и API.
- `templates/` — HTML-шаблон интерфейса.
- `static/` — стили интерфейса.
- `core/` — данные, константы, трансформации, I/O модели.
- `attacks.py` — движок атак (NormalizedModel, FGSM/BIM/PGD/DeepFool/C&W/AutoAttack).
- `models/` — веса моделей `.pt` (VGG16 с головой на 10 классов).
- `stl10_binary/` — датасет STL-10 train (`train_X.bin`, `train_y.bin`).
- `APP_DOC.txt` — краткая справка по приложению.

## Требования и окружение

- Python 3.11 (venv внутри проекта).
- `torch`, `torchvision`, `pillow`, `flask`.
- Дополнительно для атак: `torchattacks`.
- AutoAttack: используется упрощенная реализация в `attacks.py` (без внешнего пакета).

Установка зависимостей в venv:

```
.\venv\Scripts\pip.exe install torchattacks
```

## Как запустить

1) Убедитесь, что установлены зависимости (`torch`, `torchvision`, `pillow`, `flask`).
2) Запустите сервер:

```
.\venv\Scripts\python.exe main.py
```

3) Откройте браузер и перейдите на `http://localhost:8000`.

Путь к данным и модели задается в интерфейсе (в блоке «Настройки»), сохраняется в `.na_project.json` и используется при следующем запуске.

## Откуда берутся данные

Приложение читает STL-10 train из бинарников:

- `stl10_binary/train_X.bin`
- `stl10_binary/train_y.bin`

Исходный размер изображения: 96x96x3 (uint8).

## Модель

Архитектура: VGG16 с пользовательской головой на 10 классов:

- Linear(4096) -> ReLU -> Dropout
- Linear(512) -> ReLU -> Dropout
- Linear(10)

Веса загружаются из `models/*.pt`.

## Препроцессинг инференса

Для инференса и атак используется единый препроцессинг:

1) resize до 256
2) center crop до 224
3) normalize ImageNet mean/std:

```
mean = (0.485, 0.456, 0.406)
std  = (0.229, 0.224, 0.225)
```

В атакующем движке используется `NormalizedModel`, который применяет normalize внутри forward().

## Окно атак

Интерфейс атак работает в браузере и отображает:

- список индексов и кнопку запуска атак;
- таблицу результатов (до/после, успех, нормы, время);
- три превью (original/adv/diff) размером 96×96.

## AutoAttack

Полная версия AutoAttack не устанавливается из PyPI. В проекте используется упрощенная реализация:

- FGSM
- BIM
- PGD (random start)

Из трех кандидатов выбирается тот, у которого максимальная потеря (CE).

## Файлы, с которыми работает приложение

- Обязательные: `stl10_binary/train_X.bin`, `stl10_binary/train_y.bin`, `models/*.pt`.
- Опциональные: `stl/` (не используется в текущем UI), `lern.ipynb` (обучение, не требуется для запуска).

## Ограничения

- Не сохраняет результаты на диск.
